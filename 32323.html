<!DOCTYPE html>
<html>
<head>
    <title>pretty data</title>
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.10/lodash.min.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>
<p id = "textstore" style="display:none"></p>

<h1>pretty data</h1>
<div id="progress">
  <div id="bar"></div>
</div>
<input type="file" onchange="readFile(event)">
<br>
<br>
<div style = "overflow-x:auto;">
    <table id = "table">
    </table>
</div>

<script>
var finaltable = ""

function readFile(event) {
    var fileList = event.target.files;

    var reader = new FileReader();

    reader.onload = function(loadedEvent) {
        filetext = loadedEvent.target.result;
        document.getElementById("textstore").innerHTML = filetext;
        splitText();
    }
    reader.readAsText(fileList[0]);
}

function splitText() {
    filetext = document.getElementById("textstore").innerHTML;
    var columns = filetext.split("\n");
    var i;
    for (i = 0; i < columns.length; i++) {
        var row = columns[i].split(",");
        displayNewRow(row, i)
    }
}

function displayNewRow(data, rownumber) {
    var appendsfirst = "";
    var appendslast = "";
    var appendstype = "";

    if (rownumber == 0) {
        appendsfirst = "<thead>";
        appendstype = "th";
        appendslast = "</th></thead><tbody>";
    }
    else if (rownumber == data.length+1) {
        appendsfirst = "<tr>";
        appendstype = "td";
        appendslast = "</tr></tbody>";
    }
    else {
        appendsfirst = "<tr>";
        appendstype = "td";
        appendslast = "</tr>";
    }

    finaltable += appendsfirst;
    var i;
    for (i = 0; i < data.length; i++) {
        finaltable += "<" + appendstype + ">" + data[i] + "</" + appendstype + ">";
    }
    finaltable += appendslast;
    move(data.length);
    if (rownumber % 10 == 0 || rownumber <= 10) {
        document.getElementById("table").innerHTML = finaltable;
    }

}

function move(sections) {
    var elem = document.getElementById("bar");
    var width = 0;
    var individualsection = 300/(sections-1);
    console.log(individualsection);
    width = width + individualsection;
    elem.style.width = width + "%";
}
</script>

</body>
</html>

